A = filter( customer.mktsegment == "MACHINERY" )
B = dot( A, orders.custkey )
C = filter( orders.orderdate < "1995-03-10" )
D = hadamard( B, C )
E = krao( D, orders.orderdate )
F = krao( E, orders.shippriority )
G = dot( F, lineitem.orderkey )
H = filter( lineitem.shipdate > "1995-03-10" )
I = krao( G, H )
J = krao( lineitem.orderkey, I )
K = lift( lineitem.extendedprice * (1 - lineitem.discount) )
L = krao( J, K )
M = sum( L )
return( M )
